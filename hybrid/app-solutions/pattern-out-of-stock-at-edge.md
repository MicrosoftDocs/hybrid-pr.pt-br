---
title: Detecção de indisponibilidade de estoque usando o Azure e o Azure Stack Edge
description: Saiba como usar os serviços do Azure e do Azure Stack Edge para implementar a detecção de indisponibilidade de estoque.
author: BryanLa
ms.topic: article
ms.date: 11/05/2019
ms.author: bryanla
ms.reviewer: anajod
ms.lastreviewed: 11/05/2019
ms.openlocfilehash: 865f63bc4234e50ed169aa29cefdb1886750594c
ms.sourcegitcommit: bb3e40b210f86173568a47ba18c3cc50d4a40607
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 06/17/2020
ms.locfileid: "84909829"
---
# <a name="out-of-stock-detection-at-the-edge-pattern"></a><span data-ttu-id="3a1c3-103">Detecção de indisponibilidade de estoque no padrão de borda</span><span class="sxs-lookup"><span data-stu-id="3a1c3-103">Out of stock detection at the edge pattern</span></span>

<span data-ttu-id="3a1c3-104">Esse padrão ilustra como determinar se as prateleiras têm itens fora de estoque usando uma borda Azure Stack ou Azure IoT Edge dispositivos e câmeras de rede.</span><span class="sxs-lookup"><span data-stu-id="3a1c3-104">This pattern illustrates how to determine if shelves have out of stock items using an Azure Stack Edge or Azure IoT Edge device and network cameras.</span></span>

## <a name="context-and-problem"></a><span data-ttu-id="3a1c3-105">Contexto e problema</span><span class="sxs-lookup"><span data-stu-id="3a1c3-105">Context and problem</span></span>

<span data-ttu-id="3a1c3-106">Lojas de varejo físicas perdem vendas porque, quando os clientes procuram um item, ele não está presente na prateleira.</span><span class="sxs-lookup"><span data-stu-id="3a1c3-106">Physical retail stores lose sales because when customers look for an item, it's not present on the shelf.</span></span> <span data-ttu-id="3a1c3-107">No entanto, o item pode estar na parte de trás da loja e não foi recolocado em estoque.</span><span class="sxs-lookup"><span data-stu-id="3a1c3-107">However, the item could have been in the back of the store and not been restocked.</span></span> <span data-ttu-id="3a1c3-108">Os armazenamentos gostariam de usar sua equipe com mais eficiência e ser notificado automaticamente quando os itens precisarem de reabastecimento.</span><span class="sxs-lookup"><span data-stu-id="3a1c3-108">Stores would like to use their staff more efficiently and get automatically notified when items need restocking.</span></span>

## <a name="solution"></a><span data-ttu-id="3a1c3-109">Solução</span><span class="sxs-lookup"><span data-stu-id="3a1c3-109">Solution</span></span>

<span data-ttu-id="3a1c3-110">O exemplo de solução usa um dispositivo de borda, como um Azure Stack Edge em cada loja, que processa com eficiência os dados de câmeras na loja.</span><span class="sxs-lookup"><span data-stu-id="3a1c3-110">The solution example uses an edge device, like an Azure Stack Edge in each store, which efficiently processes data from cameras in the store.</span></span> <span data-ttu-id="3a1c3-111">Esse design otimizado permite que os armazenamentos enviem apenas as imagens e os eventos relevantes para a nuvem.</span><span class="sxs-lookup"><span data-stu-id="3a1c3-111">This optimized design lets stores send only relevant events and images to the cloud.</span></span> <span data-ttu-id="3a1c3-112">O design economiza largura de banda, espaço de armazenamento e garante a privacidade do cliente.</span><span class="sxs-lookup"><span data-stu-id="3a1c3-112">The design saves bandwidth, storage space, and ensures customer privacy.</span></span> <span data-ttu-id="3a1c3-113">À medida que os quadros são lidos de cada câmera, um modelo de ML processa a imagem e retorna todas as áreas de estoque.</span><span class="sxs-lookup"><span data-stu-id="3a1c3-113">As frames are read from each camera, an ML model processes the image and returns any out of stock areas.</span></span> <span data-ttu-id="3a1c3-114">As áreas de imagem e fora de estoque são exibidas em um aplicativo Web local.</span><span class="sxs-lookup"><span data-stu-id="3a1c3-114">The image and out of stock areas are displayed on a local web app.</span></span> <span data-ttu-id="3a1c3-115">Esses dados podem ser enviados para um ambiente de análise de série temporal para mostrar informações no Power BI.</span><span class="sxs-lookup"><span data-stu-id="3a1c3-115">This data can be sent to a Time Series Insight environment to show insights in Power BI.</span></span>

![Fora de estoque na arquitetura da solução de borda](media/pattern-out-of-stock-at-edge/solution-architecture.png)

<span data-ttu-id="3a1c3-117">Veja como a solução funciona:</span><span class="sxs-lookup"><span data-stu-id="3a1c3-117">Here's how the solution works:</span></span>

1. <span data-ttu-id="3a1c3-118">As imagens são capturadas de uma câmera de rede por HTTP ou RTSP.</span><span class="sxs-lookup"><span data-stu-id="3a1c3-118">Images are captured from a network camera over HTTP or RTSP.</span></span>
2. <span data-ttu-id="3a1c3-119">A imagem é redimensionada e enviada para o driver de inferência, que se comunica com o modelo ML para determinar se há alguma imagem de indisponibilidade de estoque.</span><span class="sxs-lookup"><span data-stu-id="3a1c3-119">The image is resized and sent to the inference driver, which communicates with the ML model to determine if there are any out of stock images.</span></span>
3. <span data-ttu-id="3a1c3-120">O modelo ML retorna qualquer área fora de estoque.</span><span class="sxs-lookup"><span data-stu-id="3a1c3-120">The ML model returns any out of stock areas.</span></span>
4. <span data-ttu-id="3a1c3-121">O driver inferência carrega a imagem bruta em um blob (se especificado) e envia os resultados do modelo para o Hub IoT do Azure e um processador de caixa delimitadora no dispositivo.</span><span class="sxs-lookup"><span data-stu-id="3a1c3-121">The inferencing driver uploads the raw image to a blob (if specified), and sends the results from the model to Azure IoT Hub and a bounding box processor on the device.</span></span>
5. <span data-ttu-id="3a1c3-122">O processador da caixa delimitadora adiciona caixas delimitadoras à imagem e armazena em cache o caminho da imagem em um banco de dados na memória.</span><span class="sxs-lookup"><span data-stu-id="3a1c3-122">The bounding box processor adds bounding boxes to the image and caches the image path in an in-memory database.</span></span>
6. <span data-ttu-id="3a1c3-123">O aplicativo Web consulta imagens e as mostra na ordem recebida.</span><span class="sxs-lookup"><span data-stu-id="3a1c3-123">The web app queries for images and shows them in the order received.</span></span>
7. <span data-ttu-id="3a1c3-124">As mensagens do Hub IoT são agregadas em Time Series Insights.</span><span class="sxs-lookup"><span data-stu-id="3a1c3-124">Messages from IoT Hub are aggregated in Time Series Insights.</span></span>
8. <span data-ttu-id="3a1c3-125">Power BI exibe um relatório interativo de itens fora de estoque ao longo do tempo com os dados de Time Series Insights.</span><span class="sxs-lookup"><span data-stu-id="3a1c3-125">Power BI displays an interactive report of out of stock items over time with the data from Time Series Insights.</span></span>


## <a name="components"></a><span data-ttu-id="3a1c3-126">Componentes</span><span class="sxs-lookup"><span data-stu-id="3a1c3-126">Components</span></span>

<span data-ttu-id="3a1c3-127">Essa solução usa os seguintes componentes:</span><span class="sxs-lookup"><span data-stu-id="3a1c3-127">This solution uses the following components:</span></span>

| <span data-ttu-id="3a1c3-128">Camada</span><span class="sxs-lookup"><span data-stu-id="3a1c3-128">Layer</span></span> | <span data-ttu-id="3a1c3-129">Componente</span><span class="sxs-lookup"><span data-stu-id="3a1c3-129">Component</span></span> | <span data-ttu-id="3a1c3-130">Descrição</span><span class="sxs-lookup"><span data-stu-id="3a1c3-130">Description</span></span> |
|----------|-----------|-------------|
| <span data-ttu-id="3a1c3-131">Hardware local</span><span class="sxs-lookup"><span data-stu-id="3a1c3-131">On-premises hardware</span></span> | <span data-ttu-id="3a1c3-132">Câmera de rede</span><span class="sxs-lookup"><span data-stu-id="3a1c3-132">Network camera</span></span> | <span data-ttu-id="3a1c3-133">Uma câmera de rede é necessária, com um feed HTTP ou RTSP para fornecer as imagens para inferência.</span><span class="sxs-lookup"><span data-stu-id="3a1c3-133">A network camera is required, with either an HTTP or RTSP feed to provide the images for inference.</span></span> |
| <span data-ttu-id="3a1c3-134">Azure</span><span class="sxs-lookup"><span data-stu-id="3a1c3-134">Azure</span></span> | <span data-ttu-id="3a1c3-135">Hub IoT do Azure</span><span class="sxs-lookup"><span data-stu-id="3a1c3-135">Azure IoT Hub</span></span> | <span data-ttu-id="3a1c3-136">O [Hub IOT do Azure](/azure/iot-hub/) manipula o provisionamento de dispositivos e mensagens para os dispositivos de borda.</span><span class="sxs-lookup"><span data-stu-id="3a1c3-136">[Azure IoT Hub](/azure/iot-hub/) handles device provisioning and messaging for the edge devices.</span></span> |
|  | <span data-ttu-id="3a1c3-137">Azure Time Series Insights</span><span class="sxs-lookup"><span data-stu-id="3a1c3-137">Azure Time Series Insights</span></span> | <span data-ttu-id="3a1c3-138">[Azure Time Series insights](/azure/time-series-insights/) armazena as mensagens do Hub IOT para visualização.</span><span class="sxs-lookup"><span data-stu-id="3a1c3-138">[Azure Time Series Insights](/azure/time-series-insights/) stores the messages from IoT Hub for visualization.</span></span> |
|  | <span data-ttu-id="3a1c3-139">Power BI</span><span class="sxs-lookup"><span data-stu-id="3a1c3-139">Power BI</span></span> | <span data-ttu-id="3a1c3-140">[O Microsoft Power bi](https://powerbi.microsoft.com/) fornece relatórios voltados para a empresa de eventos de ausência de estoque.</span><span class="sxs-lookup"><span data-stu-id="3a1c3-140">[Microsoft Power BI](https://powerbi.microsoft.com/) provides business-focused reports of out of stock events.</span></span> <span data-ttu-id="3a1c3-141">Power BI fornece uma interface de painel fácil de usar para exibir a saída de Azure Stream Analytics.</span><span class="sxs-lookup"><span data-stu-id="3a1c3-141">Power BI provides an easy-to-use dashboard interface for viewing the output from Azure Stream Analytics.</span></span> |
| <span data-ttu-id="3a1c3-142">Borda de Azure Stack ou</span><span class="sxs-lookup"><span data-stu-id="3a1c3-142">Azure Stack Edge or</span></span><br><span data-ttu-id="3a1c3-143">Dispositivo Azure IoT Edge</span><span class="sxs-lookup"><span data-stu-id="3a1c3-143">Azure IoT Edge device</span></span> | <span data-ttu-id="3a1c3-144">Azure IoT Edge</span><span class="sxs-lookup"><span data-stu-id="3a1c3-144">Azure IoT Edge</span></span> | <span data-ttu-id="3a1c3-145">[Azure IOT Edge](/azure/iot-edge/) orquestra o tempo de execução para os contêineres locais e manipula o gerenciamento de dispositivos e as atualizações.</span><span class="sxs-lookup"><span data-stu-id="3a1c3-145">[Azure IoT Edge](/azure/iot-edge/) orchestrates the runtime for the on-premises containers and handles device management and updates.</span></span>|
| | <span data-ttu-id="3a1c3-146">Brainwave do projeto do Azure</span><span class="sxs-lookup"><span data-stu-id="3a1c3-146">Azure project brainwave</span></span> | <span data-ttu-id="3a1c3-147">Em um dispositivo Azure Stack Edge, o [Project BrainWave](https://blogs.microsoft.com/ai/build-2018-project-brainwave/) usa FPGAs (matrizes de portão programável por campo) para acelerar o ml inferência.</span><span class="sxs-lookup"><span data-stu-id="3a1c3-147">On an Azure Stack Edge device, [Project Brainwave](https://blogs.microsoft.com/ai/build-2018-project-brainwave/) uses Field-Programmable Gate Arrays (FPGAs) to accelerate ML inferencing.</span></span>|

## <a name="issues-and-considerations"></a><span data-ttu-id="3a1c3-148">Problemas e considerações</span><span class="sxs-lookup"><span data-stu-id="3a1c3-148">Issues and considerations</span></span>

<span data-ttu-id="3a1c3-149">Considere os seguintes pontos ao decidir como implementar essa solução:</span><span class="sxs-lookup"><span data-stu-id="3a1c3-149">Consider the following points when deciding how to implement this solution:</span></span>

### <a name="scalability"></a><span data-ttu-id="3a1c3-150">Escalabilidade</span><span class="sxs-lookup"><span data-stu-id="3a1c3-150">Scalability</span></span>

<span data-ttu-id="3a1c3-151">A maioria dos modelos de aprendizado de máquina só pode ser executada em um determinado número de quadros por segundo, dependendo do hardware fornecido.</span><span class="sxs-lookup"><span data-stu-id="3a1c3-151">Most machine learning models can only run at a certain number of frames per second, depending on the provided hardware.</span></span> <span data-ttu-id="3a1c3-152">Determine a taxa de amostragem ideal de suas câmeras para garantir que o pipeline ML não faça backup.</span><span class="sxs-lookup"><span data-stu-id="3a1c3-152">Determine the optimal sample rate from your camera(s) to ensure that the ML pipeline doesn't back up.</span></span> <span data-ttu-id="3a1c3-153">Tipos diferentes de hardware tratarão diferentes números de câmeras e taxas de quadros.</span><span class="sxs-lookup"><span data-stu-id="3a1c3-153">Different types of hardware will handle different numbers of cameras and frame rates.</span></span>

### <a name="availability"></a><span data-ttu-id="3a1c3-154">Disponibilidade</span><span class="sxs-lookup"><span data-stu-id="3a1c3-154">Availability</span></span>

<span data-ttu-id="3a1c3-155">É importante considerar o que pode acontecer se o dispositivo de borda perder a conectividade.</span><span class="sxs-lookup"><span data-stu-id="3a1c3-155">It's important to consider what might happen if the edge device loses connectivity.</span></span> <span data-ttu-id="3a1c3-156">Considere quais dados podem ser perdidos na Time Series Insights e Power BI painel.</span><span class="sxs-lookup"><span data-stu-id="3a1c3-156">Consider what data might be lost from the Time Series Insights and Power BI dashboard.</span></span> <span data-ttu-id="3a1c3-157">A solução de exemplo como fornecida não foi projetada para ser altamente disponível.</span><span class="sxs-lookup"><span data-stu-id="3a1c3-157">The example solution as provided isn't designed to be highly available.</span></span>

### <a name="manageability"></a><span data-ttu-id="3a1c3-158">Capacidade de gerenciamento</span><span class="sxs-lookup"><span data-stu-id="3a1c3-158">Manageability</span></span>

<span data-ttu-id="3a1c3-159">Essa solução pode abranger vários dispositivos e locais, o que pode ficar complicado.</span><span class="sxs-lookup"><span data-stu-id="3a1c3-159">This solution can span many devices and locations, which could get unwieldy.</span></span> <span data-ttu-id="3a1c3-160">Os serviços de IoT do Azure podem automaticamente colocar novos locais e dispositivos online e mantê-los atualizados.</span><span class="sxs-lookup"><span data-stu-id="3a1c3-160">Azure's IoT services can automatically bring new locations and devices online and keep them up to date.</span></span> <span data-ttu-id="3a1c3-161">Os procedimentos de governança de dados adequados também devem ser seguidos.</span><span class="sxs-lookup"><span data-stu-id="3a1c3-161">Proper data governance procedures must be followed as well.</span></span>

### <a name="security"></a><span data-ttu-id="3a1c3-162">Segurança</span><span class="sxs-lookup"><span data-stu-id="3a1c3-162">Security</span></span>

<span data-ttu-id="3a1c3-163">Esse padrão manipula dados potencialmente confidenciais.</span><span class="sxs-lookup"><span data-stu-id="3a1c3-163">This pattern handles potentially sensitive data.</span></span> <span data-ttu-id="3a1c3-164">Verifique se as chaves são giradas regularmente e se as permissões na conta de armazenamento do Azure e nos compartilhamentos locais estão definidas corretamente.</span><span class="sxs-lookup"><span data-stu-id="3a1c3-164">Make sure keys are regularly rotated and the permissions on the Azure Storage Account and local shares are correctly set.</span></span>

## <a name="next-steps"></a><span data-ttu-id="3a1c3-165">Próximas etapas</span><span class="sxs-lookup"><span data-stu-id="3a1c3-165">Next steps</span></span>

<span data-ttu-id="3a1c3-166">Para saber mais sobre os tópicos apresentados neste artigo:</span><span class="sxs-lookup"><span data-stu-id="3a1c3-166">To learn more about topics introduced in this article:</span></span>
- <span data-ttu-id="3a1c3-167">Vários serviços relacionados à IoT são usados neste padrão, incluindo [Azure IOT Edge](/azure/iot-edge/), [Hub IOT do Azure](/azure/iot-hub/)e [Azure Time Series insights](/azure/time-series-insights/).</span><span class="sxs-lookup"><span data-stu-id="3a1c3-167">Multiple IoT related services are used in this pattern, including [Azure IoT Edge](/azure/iot-edge/), [Azure IoT Hub](/azure/iot-hub/), and [Azure Time Series Insights](/azure/time-series-insights/).</span></span>
- <span data-ttu-id="3a1c3-168">Para saber mais sobre o Microsoft Project BrainWave, confira [o comunicado do blog](https://blogs.microsoft.com/ai/build-2018-project-brainwave/) e faça checkout do [Machine Learning acelerado do Azure com o Project BrainWave Video](https://www.youtube.com/watch?v=DJfMobMjCX0).</span><span class="sxs-lookup"><span data-stu-id="3a1c3-168">To learn more about Microsoft Project Brainwave, see [the blog announcement](https://blogs.microsoft.com/ai/build-2018-project-brainwave/) and checkout out the [Azure Accelerated Machine Learning with Project Brainwave video](https://www.youtube.com/watch?v=DJfMobMjCX0).</span></span>
- <span data-ttu-id="3a1c3-169">Consulte [considerações de design de aplicativo híbrido](overview-app-design-considerations.md) para saber mais sobre as práticas recomendadas e obter respostas para outras perguntas.</span><span class="sxs-lookup"><span data-stu-id="3a1c3-169">See [Hybrid app design considerations](overview-app-design-considerations.md) to learn more about best practices and to get answers to any additional questions.</span></span>
- <span data-ttu-id="3a1c3-170">Consulte a [família de produtos e soluções Azure Stack](/azure-stack) para saber mais sobre todo o portfólio de produtos e soluções.</span><span class="sxs-lookup"><span data-stu-id="3a1c3-170">See the [Azure Stack family of products and solutions](/azure-stack) to learn more about the entire portfolio of products and solutions.</span></span>

<span data-ttu-id="3a1c3-171">Quando você estiver pronto para testar o exemplo de solução, continue com os [dados em camadas para o guia de implantação da solução de análise](https://aka.ms/edgeinferencingdeploy).</span><span class="sxs-lookup"><span data-stu-id="3a1c3-171">When you're ready to test the solution example, continue with the [Tiered data for analytics solution deployment guide](https://aka.ms/edgeinferencingdeploy).</span></span> <span data-ttu-id="3a1c3-172">O guia de implantação fornece instruções passo a passo para implantar e testar seus componentes.</span><span class="sxs-lookup"><span data-stu-id="3a1c3-172">The deployment guide provides step-by-step instructions for deploying and testing its components.</span></span>
